# This is not a standalone Makefile
# It is intended to be included in other Makefiles

# It defines macros for QOP (SciDAC Level 3)
# HAVEQOP          What we are compiling with
# LIBQOP INCQOP    The -L and -I compiler and linker lists
# INCDEPQOP LIBDEPQOP  Lists for make dependencies
# ASQFORCEQOP

# Requires input macros
# WANTQOP                 User requests (true or otherwise)

HAVEQOP = ${WANTQOP}

# Nothing needs to be defined here if we don't want QOP
ifeq ($(strip ${HAVEQOP}),true)

  # Temporary paths for QCDOC.
  QCDOCQOP=/qcdoc/sfw/SciDAC/Asqtad_L3/v1.0/
  # We always need the qop.h header
  QOPINCDIR = ${QOP}/include
  # In case QOP is packaged we need the path
  QOPLIBDIR = ${QOP}/lib
  
  ifeq ($(strip ${QCDOC}),true)
  # QCDOC temporary paths
  # We always need the qop.h header
    QOPINCDIR = ${QCDOCQOP}/include
  # In case QOP is packaged we need the path
    QOPLIBDIR = ${QCDOCQOP}/build
    ifeq ($(strip ${PRECISION}),1)
      IQOP = -I${QOPINCDIR}
      LQOP = -L${QOPLIBDIR} -lasqd_s
    else
      IQOP = -I${QOP}/include/
      LQOP = -L${QOPLIBDIR} -lasqd
    endif
    LIBDEPQOP = ${QOPLIBDIR}
    INCDEPQOP = ${QOPINCDIR}
  else
    IQOP = -I${QOPINCDIR}
    INCDEPQOP = ${QOPINCDIR}
  # Non-packaged QOP objects
  
  # MILC implementation 
  # General
      GENERICQOP = qop_milc.o 
  # Conjugate gradient
      ASQINVERTQOP += d_congrad5_fn_qop_milc.o dslash_fn_qop_milc.o
  # Fermion force
      ASQFORCEQOP += fermion_force_asqtad_qop_milc.o ff_opt.o
  endif
  
  
  ifeq ($(strip ${HAVEQOP}),true)
    LIBQOP = ${LQOP}
    INCQOP = ${IQOP}
  endif

endif  # if HAVEQOP

