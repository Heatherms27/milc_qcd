#  MIMD version 6
#  Standard application makefile for the Berkeley NOW
#  Do not use for making libraries
#  Copy this file into the application directory and run make there.
#

# This file
MAKEFILE = Make_now_mpi
COMMTYPE = MPI

#----------------------------------------------------------------------
#  User choices - edit to suit 
#----------------------------------------------------------------------
# 1. Compiler
CC               = /usr/sww/opt/SUNWspro/bin/cc    # ( )

#----------------------------------------------------------------------
# 2. Compiler optimization level
OPT              = -O    # ( -g, etc )

#----------------------------------------------------------------------
# 3. Other compiler optimization flags.  Uncomment stanza to suit.
#-------------- SGI Origin -------------------------------------
OCFLAGS = -dalign -xrestrict -xarch=v8plusa -xchip=ultra -fast -xtarget=ultra -xO5 ${CFLAGS0}      # Berkeley NOW (ultra-sparc)

#----------------------------------------------------------------------
# 4. Choose large file support
CLFS =   # Not researched for NOW

#----------------------------------------------------------------------
# 5. Installation-specific MPI includes and libraries (if not using mpicc)
#----------------- Berkeley NOW ---------------------------------------
#CMPI = -I/usr/now/mpi/mpich/include -I/usr/now/include\
# -I/usr/now/mpi/mpich/include

#LMPI = -L/usr/now/mpi/mpich/lib/solaris/am2 -L/usr/now/lib\
# -L/usr/now/am2/lib -lmpi -lens -leutl -lglunix -lam2 -lthread \
# -lposix4 -lsocket -lnsl

#----------------------------------------------------------------------
# 6. I/O routines
MACHINE_DEP_IO   = io_nonansi.o # ( io_romio.o )

#----------------------------------------------------------------------
# 7. Linker
LD               = ${CC}

#----------------------------------------------------------------------
# 8. Extra linker flags
LDFLAGS          =            #

#----------------------------------------------------------------------
# 9. Extra load libraries
ILIB             = ${LMPI}    #

#----------------------------------------------------------------------
# 10. Code alternatives 
# The redefine of MPI_Issend works around what is probably an MPI
# bug on the NOW
CODETYPE         = -DINLINE -DMPI_Issend=MPI_Isend  # usually unchanged

#----------------------------------------------------------------------
# 11. Choose MILC library make file in libraries directory.  
#    CHECK IT FOR FURTHER OPTIONS!

MAKELIBRARIES = Make_vanilla  # Generic.

#----------------------------------------------------------------------
# End of user choices.  PLEASE, ALSO, CHECK include/config.h.
#----------------------------------------------------------------------

# Routines that depend on both application and architecture
MACHINE_DEP = com_mpi.o ${MACHINE_DEP_IO}

# Complete set of compiler flags - do not change
CFLAGS = ${OPT} ${OCFLAGS} -D${COMMTYPE} ${CODETYPE} ${CLFS} ${CMPI} -I${MYINCLUDEDIR} ${DEFINES}

include Make_template
