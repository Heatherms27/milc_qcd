# This is not a standalone Makefile
# It is intended to be included in other Makefiles

# It defines these macros
# HAVEQDP HAVEQIO HAVEQMP          What we are compiling with
# LIBSCIDAC INCSCIDAC              The -L and -I compiler and linker lists
# SCIDAC_LIBRARIES SCIDAC_HEADERS  Lists for make dependencies

# Requires input macros
# MPP                     true if multiprocessor compilation
# QMPPAR                  Path to multiprocessor QMP
# QMPSNG                  Path to single processor QMP
# QIO                     Path to the QIO package
# QLA                     Path to the QLA package
# QDP                     Path to the QDP package
# WANTQDP WANTQIO WANTQMP User requests (true or otherwise)
# WANTQOP                 User requests (true or otherwise)

HAVEQOP = ${WANTQOP}

HAVEQDP = ${WANTQDP}

ifeq ($(strip ${HAVEQDP}),true)
   HAVEQIO = true #
else
   HAVEQIO = ${WANTQIO}
endif

ifeq ($(strip ${HAVEQIO}),true)
   HAVEQMP = true
else
   HAVEQMP = ${WANTQMP}
endif

# Shouldn't need to change the rest of this stanza (except see "QCDOC
# nonstandard")

ifeq ($(strip ${MPP}),true)
   QMP = ${QMPPAR}
else
   QMP = ${QMPSNG}
endif

# Allow for QCDOC non-standard for now for QMP installation
ifeq ($(strip ${QCDOC}),true)
  QMPINCDIR = ${QOS}/quser/include
  QMPLIBDIR = ${QOS}/quser/gcc-lib-user
else
  QMPINCDIR = ${QMP}/include
  QMPLIBDIR = ${QMP}/lib
endif

QIOINCDIR = ${QIO}/include
QIOLIBDIR = ${QIO}/lib
QLAINCDIR = ${QLA}/include
QLALIBDIR = ${QLA}/lib
QDPINCDIR = ${QDP}/include
QDPLIBDIR = ${QDP}/lib
# QCDOC temporary
QOPINCDIR = ${QOP}/include
QOPLIBDIR = ${QOP}/build

#IQMP = -I${QMPINCDIR}
#LQMP = -L$(QMP)/lib -lqmp

# QCDOC nonstandard
IQMP = -I${QOS}/quser/include
LQMP = -L${QOS}/quser/gcc-lib-user -lqmp

IQIO = -I${QIOINCDIR}
LQIO = -L${QIOLIBDIR} -lqio -llime 

IQLA = -I${QLAINCDIR}
LQLA = -L${QLA}/lib -lqla_int -lqla_f -lqla_f3 -lqla_df -lqla_d3 -lqla_df3 \
          -lqla_dq3 -lqla_q3 -lqla_d -lqla_dq -lqla_q -lqla_random

IQDP = -I${QDP}/include
LQDP = -L${QDP}/lib -lqdp_int -lqdp_f -lqdp_f3 -lqdp_d -lqdp_d3 -lqdp_common

# QCDOC temporary paths
ifeq ($(strip ${PRECISION}),1)
  IQOP = -DSCIDAC -DASQD_SINGLE -I${QOPINCDIR}
else
  IQOP = -DSCIDAC -I${QOP}/include/
endif
LQOP = -L${QOPLIBDIR} -lasqd_s

ifeq ($(strip ${HAVEQMP}),true)
  LIBQMP = ${LQMP}
  INCQMP = ${IQMP}
  INCDEPQMP = ${QMPINCDIR}
  LIBDEPQMP = ${QMPLIBDIR}
endif

ifeq ($(strip ${HAVEQIO}),true)
  LIBQIO = ${LQIO}
  INCQIO = ${IQIO}
  INCDEPQIO = ${QIOINCDIR}
  LIBDEPQIO = ${QIOLIBDIR}
endif

ifeq ($(strip ${HAVEQDP}),true)
  LIBQDP = ${LQDP} ${LQLA}
  INCQDP = ${IQDP} ${IQLA}
  INCDEPQDP = ${QDPINCDIR} ${QLAINCDIR}
  LIBDEPQDP = ${QDPLIBDIR} ${QLALIBDIR}
endif

ifeq ($(strip ${HAVEQOP}),true)
  LIBQOP = ${LQOP}
  INCQOP = ${IQOP}
  INCDEPQOP = ${QOPINCDIR}
  LIBDEPQOP = ${QOPLIBDIR}
endif

LIBSCIDAC = ${LIBQDP} ${LIBQIO} ${LIBQMP} ${LIBQOP}
INCSCIDAC = ${INCQDP} ${INCQIO} ${INCQMP} ${INCQOP}
SCIDAC_LIBRARIES = ${LIBDEPQDP} ${LIBDEPQIO} ${LIBDEPQMP} ${LIBDEPQOP}
SCIDAC_HEADERS = ${INCDEPQDP} ${INCDEPQIO} ${INCDEPQMP} ${INCDEPQOP}
