#  MIMD version 6
#  Standard application makefile for the NCSA NT cluster
#  Do not use for making libraries
#  Copy this file into the application directory and run make there.
#

# This file
MAKEFILE = Make_nt_mpi
COMMTYPE = MPI

#----------------------------------------------------------------------
#  User choices - edit to suit 
#----------------------------------------------------------------------
# 1. Compiler
CC               = cl    # ( the only choice! )

#----------------------------------------------------------------------
# 2. Compiler optimization level
OPT              = -Ox -Oa    # 

#----------------------------------------------------------------------
# 3. Other compiler optimization flags.  Uncomment stanza to suit.
#-------------- NT cl -------------------------------------
OCFLAGS = -Fo$*.o -G6 

#----------------------------------------------------------------------
# 4. Choose large file support
CLFS =             # Not researched for NT cluster

#----------------------------------------------------------------------
# 5. Installation-specific MPI includes and libraries (if not using mpicc)
#----------------- NCSA  ------------------------------------------
CMPI = -Id:/apps/hpvm/myrinet/include -DMPI_Issend=MPI_Isend 
LMPI = d:/apps/hpvm/myrinet/lib/mpi.lib d:/apps/hpvm/myrinet/lib/FM.lib  d:/apps/hpvm/myrinet/lib/myrilib.lib wsock32.lib

# 6. I/O routines
MACHINE_DEP_IO   = io_nonansi.o # (io_ansi.o io_nonansi.o io_romio.o)

#----------------------------------------------------------------------
# 7. Linker
LD               = ${CC}

#----------------------------------------------------------------------
# 8. Extra linker flags
LDFLAGS          =           # most

#----------------------------------------------------------------------
# 9. Extra libraries
ILIB             = ${LMPI}    # not needed if using mpicc

#----------------------------------------------------------------------
# 10. Code alternatives 
CODETYPE         =  -DINLINE   # usually unchanged

#----------------------------------------------------------------------
# 11. Choose MILC library make file in libraries directory.  
#    CHECK IT FOR FURTHER OPTIONS!

MAKELIBRARIES = Make_vanilla  # Generic.

#----------------------------------------------------------------------
# End of user choices.  Please, also, check include/config.h.
#----------------------------------------------------------------------
# Application-architecture-dependent routines
MACHINE_DEP = com_mpi.o ${MACHINE_DEP_IO}

# Complete set of compiler flags - do not change
CFLAGS = ${OPT} ${OCFLAGS} -D${COMMTYPE} ${CODETYPE} ${CLFS} ${CMPI} -I${MYINCLUDEDIR} ${DEFINES}

include Make_template


